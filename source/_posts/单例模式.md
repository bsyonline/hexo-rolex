---
title: 单例模式
toc: true
date: 2016-08-02 00:00:47
tags: 设计模式
categories: 编程
---

单例模式是最简单的设计模式之一，用于保证系统中只有一个类的实例的场景。
单例模式的特点：
* 只有一个实例
* 只能自己创建自己的实例
* 能够对外提供自己创建的实例

### 1. 懒汉式

在 Gof 的设计模式中介绍单例模式使用的说明代码叫做懒汉式，java 版代码如下：
```java
public class Singleton {
    private static Singleton instance = null;
    private Singleton() {}
    public static Singleton getInstance() {
        if (instance == null) {
            instance = new Singleton();
        }
        return instance;
    }
}

```
这是最简单的代码实现，但是这个代码存在问题，即在多线程的程序中，不能保证一定是单例的。原因也很简单，代码被编译成字节码被执行，有可能在刚进入 if 判断后时间分片就用完了，另一个线程也进入 if 判断，从而创建多个实例。一种简单的处理方法是讲方法同步。
```java
synchronized public static Singleton getInstance() {

}
```



### 2. 饿汉式

另外还有一种比较常见的叫做饿汉式，这种方式更符合 java 的风格。
```java
public class Singleton {
    private static final Singleton instance = new Singleton();

    private Singleton() {}

    public static Singleton getInstance() {
        return instance;
    }
}
```
